<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8" />
      <title>CBT-X</title>
      <link rel="shortcut icon" href="../../../../favicon.ico" />
      <link rel="stylesheet" href="../../../../styles/style.css">
      <script src="../../../../scripts/imageMapResizer.min.js"></script>
   </head>
   <body>

      <img src="../../../../images/CESDAlogo.png" class="topright" style="height:100px">
      <img id="cockpit" class="cockpit" src="../../../../images/after1.jpg" usemap="#touchcockpit">
      <map name="touchcockpit">
			<area
				id="cockpit0"
				target=""
				alt="Landing"
				title="Landing"
				coords="167,639,186,685"
				shape="rect"
				cursor="pointer"
			/>
			<area
				id="cockpit1"
				target=""
				alt="Taxi"
				title="Taxi"
				coords="204,643,223,689"
				shape="rect"
				cursor="pointer"
			/>
			<area
				id="cockpit2"
				target=""
				alt="Position"
				title="Position"
				coords="231,641,282,686"
				shape="rect"
				cursor="pointer"
			/>
			<area
				id="cockpit3"
				target=""
				alt="Strobe"
				title="Strobe"
				coords="294,639,311,688"
				shape="rect"
				cursor="pointer"
			/>
			<area
				id="cockpit4"
				target=""
				alt="Ignition"
				title="Ignition"
				coords="488,662,26"
				shape="circle"
				cursor="pointer"
			/>
			<area
				id="cockpit5"
				target=""
				alt="Prime"
				title="Prime"
				coords="566,641,615,685"
				shape="rect"
				cursor="pointer"
			/>
			<area
				id="cockpit6"
				target=""
				alt="Gen/Bat"
				title="GEN/BAT"
				coords="679,627,718,688"
				shape="rect"
				cursor="pointer"
			/>
			<area
				id="cockpit7"
				target=""
				alt="Oil Press"
				title="Oil Press"
				coords="1,1,1"
				shape="circle"
				cursor="pointer"
			/>
			<area
				id="cockpit8"
				target=""
				alt="Avionic Master"
				title="Avionic Master"
				coords="737,635,757,683"
				shape="rect"
				cursor="pointer"
			/>
	        <area
				id="cockpit9"
				target=""
				alt="Fuel Pump"
				title="Fuel Pump"
				coords="791,633,811,681"
				shape="rect"
				cursor="pointer"
			/>
		    <area
				id="cockpit10"
				target=""
				alt="Flaps"
				title="Flaps"
				coords="947,623,1000,686"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit11"
				target=""
				alt="ALTN Air"
				title="ALTN Air"
				coords="696,1002,725,1042"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit12"
				target=""
				alt="Throttle"
				title="Throttle"
				coords="730,996,834,1037"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit13"
				target=""
				alt="Mixture"
				title="Mixture"
				coords="835,734,878,807"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit14"
				target=""
				alt="Fuel Shut-off"
				title="Fuel Shut-off"
				coords="1040,739,1103,817"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit15"
				target=""
				alt="EGT"
				title="EGT"
				coords="1209,278,54"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit16"
				target=""
				alt="CHT"
				title="CHT"
				coords="1341,278,52"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit17"
				target=""
				alt="Fuel PSI"
				title="Fuel PSI"
				coords="1211,402,52"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit18"
				target=""
				alt="Fuel QTY"
				title="Fuel QTY"
				coords="1341,400,52"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit19"
				target=""
				alt="Oil TEMP"
				title="Oil TEMP"
				coords="1209,519,52"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit20"
				target=""
				alt="Oil PSI"
				title="Oil PSI"
				coords="1341,524,54"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit21"
				target=""
				alt="AMPS"
				title="AMPS"
				coords="1212,642,52"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit22"
				target=""
				alt="VOLTS"
				title="VOLTS"
				coords="1345,642,52"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit23"
				target=""
				alt="Breakers"
				title="Breakers"
				coords="1426,371,1644,373,1646,503,1848,502,1851,698,1426,697"
				shape="poly"
				cursor="pointer"
			/>
         <area
				id="cockpit24"
				target=""
				alt="Radio Panel"
				title="Radio Panel"
				coords="791,238,1127,525"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit25"
				target=""
				alt="XPNDR"
				title="XPNDR"
				coords="791,525,1124,602"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit26"
				target=""
				alt="Trim"
				title="Trim"
				coords="437,770,22"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit27"
				target=""
				alt="Trim NEUTRAL"
				title="Trim NEUTRAL"
				coords="484,142,510,193"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit28"
				target=""
				alt="RPM"
				title="RPM"
				coords="696,140,55"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit29"
				target=""
				alt="Airspeed"
				title="Airpseed"
				coords="303,281,332,420"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit30"
				target=""
				alt="Altitude"
				title="Altitude"
				coords="468,282,506,417"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit31"
				target=""
				alt="Compass"
				title="Compass"
				coords="1209,137,57"
				shape="circle"
				cursor="pointer"
			/>
         <area
				id="cockpit32"
				target=""
				alt="Stick"
				title="Stick"
				coords="457,986,415,741"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit33"
				target=""
				alt="Warning Lights"
				title="Warning Lights"
				coords="540,140,611,195"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit34"
				target=""
				alt="Parking Brake"
				title="Parking Brake"
				coords="991,892,1019,931"
				shape="rect"
				cursor="pointer"
			/>
         <area
				id="cockpit35"
				target=""
				alt="Screens"
				title="Screens"
				coords="303,259,745,525"
				shape="rect"
				cursor="pointer"
			/>
         
			
		</map>

      <div class="tablediv">
         <table id="table" align="right">
            <tr>
               <th colspan="2" id="itemtitle"><span>AFTER LANDING</span></th>
            </tr>
            <tr id="item1">
               <td><span>1. Wing Flaps</span></td>
               <td align="right"><span>CRUISE</span></td>
            </tr>
            <tr id="item2">
               <td><span>2. Taxi Light</span></td>
               <td align="right"><span>ON</span></td>
            </tr>
            <tr id="item3">
               <td><span>3. Landing Light</span></td>
               <td align="right"><span>OFF</span></td>
            </tr>
            <tr id="item4">
               <td><span>4. Strobe</span></td>
               <td align="right"><span>OFF</span></td>
            </tr>
            <tr id="item5">
               <td><span>5. XPONDER</span></td>
               <td align="right"><span>Check STBY</span></td>
            </tr>
            <tr id="item6">
               <td><span>6. Mixture</span></td>
               <td align="right"><span>Check FULL RICH</span></td>
            </tr>
            <tr id="item7">
               <td><span>7. Pitot Heat</span></td>
               <td align="right"><span>OFF</span></td>
            </tr>
         </table>
      </div>
      <a href="../normal2.html" class="btnback">BACK</a>
      <a href="../../../../menu.html" class="btnmenu">MENU</a>
      <div class="navdiv">
         <a class="btnnav startbtn" id="startbtn" onclick="start()">START</a>
         <a class="btnnav nextbtngrey" id="nextbtn">NEXT</a>
      </div>

      <script>
			// Main variables declaration
			const itemTitle = document.getElementById("itemtitle");
			const startBtn = document.getElementById("startbtn");
			const nextBtn = document.getElementById("nextbtn");
			const imgsRoute = "../../../../images/";
			let counter = 0;
			let allowCount = false;
			let tableTrIdArr = [];
			let clickableAreaElements = [];

			// Checks area HTML elements and stores each area id in the 'clickableAreaElements' Array
			const areaElements = document.getElementsByTagName("area");
			for (let i = 0; i < areaElements.length; i++) {
				if (areaElements[i].id !== "") {
					clickableAreaElements.push(areaElements[i]);
				}
			}
			console.log(clickableAreaElements);

			// Useful at Restart to acknowledge The CBT Activity has restarted on Page Reload
			if (sessionStorage.getItem("reloading") === "true") {
				sessionStorage.clear();
				start();
				startBtn.innerText = "RESTART";
			}

			// Restarts The CBT Activity
			function restart() {
				console.log("Restarting...");
				sessionStorage.setItem("reloading", "true");
				window.location.reload();
			}

			/* 
            Changes Inner Text on a selected HTML Element
               Invoke example: changeInnerText(startBtn, "RESTART")
         */
			function changeInnerText(element, string) {
				element.innerText = string;
			}

			/* 
            Applies 'highlight' class to selected HTML Element 
               Invoke example: highlightRow(tableElement)
         */
			function highlightRow(element) {
				element.classList.add("highlight");
			}

			/* 
            Modifies 'btn' styles adding/removing classes to selected Button
               Invoke example: disableBtn(nextBtn)
         */
			function disableBtn(element) {
				const lowerCaseName = element.id;
				element.classList.remove(lowerCaseName);
				element.classList.add(`${lowerCaseName}grey`);
			}

			/*
            Modifies 'btn' styles adding/removing classes to selected Button
               Invoke example: enableBtn(nextBtn)
         */
			function enableBtn(element) {
				const lowerCaseName = element.id;
				element.classList.remove(`${lowerCaseName}grey`);
				element.classList.add(lowerCaseName);
			}

			/* 
            Adds clickable functionalities to maptag elements.
               The maptag elements are selected from their index number in the clickableAreaElements Array (always starting at 0).
               The functionEventString accepts two string as options: 'continueCount(event)' or 'changeImage(event)'.
               Invoke example: setMapTagEvent(4, 'changeImage(event)');
         */
			function setMapTagEvent(elementNumber, functionEventString) {
				clickableAreaElements[elementNumber].classList.add("clickable");
				clickableAreaElements[elementNumber].setAttribute(
					"onclick",
					functionEventString
				);
			}

			/* 
            Removes clickable functionalities to maptag elements.
               The maptag elements are selected from their index number in the clickableAreaElements Array (always starting at 0).
               Invoke example: unsetMapTagEvent(4);
         */
			function unsetMapTagEvent(elementNumber) {
				clickableAreaElements[elementNumber].classList.remove("clickable");
				clickableAreaElements[elementNumber].removeAttribute("onclick");
			}










			// Starts The CBT Activity
			function start() {
				if (!allowCount) {
					itemTitle.classList.add("titlehighlight");
					startBtn.classList.remove("startbtn");
					startBtn.classList.add("startbtngrey");
					nextBtn.classList.remove("nextbtngrey");
					nextBtn.classList.add("nextbtn");
					// Checks `tr` HTML elements and stores each one id in the 'tableTrIdArr' Array
					const tableRows = document.getElementsByTagName("tr");
					for (let i = 0; i < tableRows.length; i++) {
						if (tableRows[i].id !== "") {
							tableTrIdArr.push(tableRows[i].id);
						}
					}
					startBtn.setAttribute("onclick", "restart()");
					changeInnerText(startBtn, "RESTART");
					changeInnerText(nextBtn, "TOUCH");
					disableBtn(nextBtn);
					setMapTagEvent(10, "changeImage(event)");
				}
			}














			// ACTIONS associated to the event click at `nextBtn`
			nextBtn.addEventListener("click", () => {
				if (allowCount) {
					counter++;
					console.log("Estoy en Next Btn: ", counter);
					/* La variable 'tableElement' se actualiza en cada nextBtn click (cuando ésté está habilitado) 
               agarrando el valor actual de counter y buscando el elemento de la tabla que corresponda a 'item+counter'
               */
					const tableElement = document.getElementById(`item${counter}`);

					/*
               A continuación, desarrollar las condiciones (en función del valor de counter) para ejecutar las funciones deseadas en cada caso
               */
					if (counter === 7) {
						// Applies 'highlight' class to selected HTML Element
						highlightRow(tableElement);
                  changeInnerText(nextBtn, "DONE");
                  disableBtn(nextBtn);
					} else if (counter === 4867) {
						highlightRow(tableElement);
                  changeInnerText(nextBtn, "TOUCH");
                  disableBtn(nextBtn);
                  setMapTagEvent(33, "continueCount(event)");
                  allowCount = false;
               } 
				
				}
			});














			// ACTIONS on clickable maptag elements with no image change effects
			function continueCount(event) {
				if (!allowCount) {
					counter++;
					console.log("Estoy en Evento SIN cambio de Imagen: ", counter);
					const tableElement = document.getElementById(`item${counter}`);
					highlightRow(tableElement);
					const elementId = event.composedPath()[0].attributes.id.nodeValue;
					const element = document.getElementById(elementId);
					// Same as unsetMapTagEvent for each element
					element.classList.remove("clickable");
					element.removeAttribute("onclick");
					if (counter === 1) {
                  unsetMapTagEvent(29);
						setMapTagEvent(10, "changeImage(event)");
					} else if (counter === 6) {
                  unsetMapTagEvent(13);
                  changeInnerText(nextBtn, "NEXT");
                  enableBtn(nextBtn);
                  allowCount = true;
               } 
				}
			}


















			// ACTIONS on clickable maptag elements with image change effects
			function changeImage(event) {
				allowCount = true;
				counter++;
				console.log("Estoy en Evento CON cambio de Imagen: ", counter);
				const cockpit = document.getElementById("cockpit");
				let cockpitImgRoute = cockpit.attributes.src.nodeValue;
				const tableElement = document.getElementById(`item${counter}`);
				if (cockpitImgRoute === imgsRoute + "after1.jpg") {
					cockpit.attributes.src.nodeValue = imgsRoute + "after2.jpg";
					unsetMapTagEvent(10);
					highlightRow(tableElement);
					setMapTagEvent(1, "changeImage(event)");
				} else if (cockpitImgRoute === imgsRoute + "after2.jpg") {
					cockpit.attributes.src.nodeValue = imgsRoute + "after3.jpg";
					unsetMapTagEvent(1);
					highlightRow(tableElement);
               setMapTagEvent(0, "changeImage(event)");
            } else if (cockpitImgRoute === imgsRoute + "after3.jpg") {
					cockpit.attributes.src.nodeValue = imgsRoute + "after4.jpg";
					unsetMapTagEvent(0);
					highlightRow(tableElement);
               setMapTagEvent(3, "changeImage(event)");
            } else if (cockpitImgRoute === imgsRoute + "after4.jpg") {
					cockpit.attributes.src.nodeValue = imgsRoute + "after5.jpg";
					unsetMapTagEvent(3);
					highlightRow(tableElement);
               setMapTagEvent(25, "changeImage(event)");
            } else if (cockpitImgRoute === imgsRoute + "after5.jpg") {
					cockpit.attributes.src.nodeValue = imgsRoute + "after6.jpg";
					unsetMapTagEvent(25);
					highlightRow(tableElement);
               setMapTagEvent(13, "continueCount(event)");
               allowCount = false;
               
				} 
			}

			imageMapResize();
		</script>

   </body>
</html>